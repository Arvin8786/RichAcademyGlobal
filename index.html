<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forever Living by Muhd Arvind Isa</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    :root{--primary-color:#1a5276;--secondary-color:#f39c12;--accent-color:#27ae60;--light-gray:#f4f6f8;--dark-text:#333;--light-text:#fff;--border-radius:12px;--shadow:0 4px 15px rgba(0,0,0,.08);--font-family:'Poppins',sans-serif}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideIn{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes promoGlow{0%{box-shadow:0 0 5px rgba(243,156,18,.6)}50%{box-shadow:0 0 20px rgba(243,156,18,.9)}100%{box-shadow:0 0 5px rgba(243,156,18,.6)}}@keyframes marquee{0%{transform:translateX(0%)}100%{transform:translateX(-100%)}}
    *,::after,::before{box-sizing:border-box}
    body{font-family:var(--font-family);margin:0;padding:0;background-color:var(--light-gray);color:var(--dark-text);overflow-x:hidden;line-height:1.6;padding-top:45px; position: relative;}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}h1,h2,h3,h4{color:var(--primary-color);font-weight:600}
    .default-theme .hero-section{background:linear-gradient(135deg, #2c3e50, #4ca1af);color:var(--light-text);padding:80px 20px;text-align:center;border-radius:var(--border-radius);margin-bottom:30px;transition:all .5s ease;box-shadow:0 10px 30px rgba(0,0,0,.2)}
    
    /* --- FESTIVAL THEMES --- */
    .theme-GrandOpening {background-color: #fdf5e6;}
    .theme-GrandOpening .hero-section {background: linear-gradient(135deg, #ffd700, #ff6347); border: 5px solid #fff; box-shadow: 0 0 30px rgba(255, 215, 0, 0.7);}
    .theme-GrandOpening #promo-running-banner {background-color: #ff4500; color: #ffffff;}

    .theme-HariRaya{background-color:#f0fff0}.theme-HariRaya .hero-section{background:linear-gradient(135deg, #006400, #daa520); border:4px dashed #FFD700;}.theme-HariRaya #promo-running-banner{background-color:#006400;color:#FFD700}
    .theme-Deepavali{background-color:#fff8e1}.theme-Deepavali .hero-section{background:linear-gradient(135deg, #ff6b6b, #feca57); border:4px dashed #ff9f43;}.theme-Deepavali #promo-running-banner{background-color:#e74c3c;color:#fff}
    .theme-Christmas{background-color:#f8f9fa}.theme-Christmas .hero-section{background:linear-gradient(135deg, #d32f2f, #388e3c); border:4px dashed #ffffff;}.theme-Christmas #promo-running-banner{background-color:#c62828;color:#fff}
    .theme-CNY{background-color:#fffbf0}.theme-CNY .hero-section{background:linear-gradient(135deg, #c0392b, #f1c40f); border:4px dashed #f1c40f;}.theme-CNY #promo-running-banner{background-color:#c0392b;color:#f1c40f}
    .theme-NationalDay .hero-section, .theme-MalaysiaDay .hero-section {background:linear-gradient(135deg, #000066, #cc0000); border:4px dashed #f1c40f;}
    .theme-Thaipusam .hero-section {background:linear-gradient(135deg, #ff9933, #ffffff); border:4px dashed #3366cc;}
    .theme-MooncakeFestival .hero-section {background:linear-gradient(135deg, #1a1a2e, #ff4e50); border:4px dashed #f9d423;}
    header{background-color:var(--light-text);padding:20px 0;text-align:center;border-bottom:1px solid #e0e0e0;position:relative}.header-content{display:flex;align-items:center;justify-content:center;gap:20px}.header-logo{width:80px;height:80px}.header-content h1{margin:0}.header-content h1 span{display:block}#promo-running-banner{color:var(--light-text);padding:10px 0;text-align:center;font-weight:700;font-size:1.1rem;position:fixed;top:0;left:0;width:100%;box-shadow:0 2px 5px rgba(0,0,0,.1);z-index:101;overflow:hidden;white-space:nowrap;display:none}#promo-running-banner .marquee-content{display:inline-block;padding-left:100%;animation:marquee 20s linear infinite}nav{background-color:var(--primary-color);position:sticky;top:45px;z-index:100;box-shadow:0 2px 10px rgba(0,0,0,.1)}nav ul{display:flex;list-style:none;padding:10px 0;margin:0;justify-content:center;flex-wrap:wrap}nav a{color:var(--light-text);text-decoration:none;font-weight:600;padding:10px 20px;display:inline-block;position:relative;transition:color .3s;cursor:pointer}nav a::after{content:'';position:absolute;bottom:5px;left:50%;transform:translateX(-50%);width:0;height:2px;background-color:var(--secondary-color);transition:width .3s}nav a:hover{color:#f1c40f}nav a:hover::after{width:60%}
    nav a.nav-disabled{color:#a9a9a9;pointer-events:none;cursor:not-allowed}nav a.nav-disabled:hover{color:#a9a9a9}nav a.nav-disabled::after{width:0!important}
    .tab-content{display:none;padding:20px 0}.tab-content.active{display:block;animation:fadeIn .5s}.hero-section h2{color:var(--light-text)}.ai-suggestion-box,.search-container{margin-bottom:30px;position:relative}
    #product-search{width:100%;padding:15px 50px 15px 25px;border:2px solid #ddd;border-radius:50px;font-size:1rem;outline:none;transition:all .3s}#product-search:focus{border-color:var(--primary-color);box-shadow:0 0 10px rgba(26,82,118,.2)}.search-icon{position:absolute;right:25px;top:50%;transform:translateY(-50%);color:var(--primary-color);font-size:1.2rem}
    .ai-suggestion-box{background:var(--light-text);padding:30px;border-radius:var(--border-radius);box-shadow:var(--shadow);text-align:center}#symptom-input{width:100%;padding:12px;border:1px solid #ddd;border-radius:8px;margin:10px 0}#suggest-btn{background:linear-gradient(135deg,var(--primary-color),var(--accent-color));color:var(--light-text);border:none;padding:12px 30px;border-radius:50px;cursor:pointer;font-weight:700;transition:all .3s;margin-top:10px}#suggest-btn:hover{transform:translateY(-3px);box-shadow:0 5px 15px rgba(0,0,0,.2)}#suggestion-result{margin-top:20px;text-align:left}.suggestion-product{background:#f8f9fa;padding:15px;border-radius:8px;margin:10px 0;display:flex;justify-content:space-between;align-items:center;border-left:4px solid var(--accent-color)}
    .promo-section h2 {font-size: 2rem; border-bottom: 3px solid var(--primary-color); padding-bottom: 10px; margin-bottom: 25px; margin-top: 40px;}
    .product-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:30px}.product{background:var(--light-text);border-radius:var(--border-radius);box-shadow:var(--shadow);display:flex;flex-direction:column;position:relative;transition:all .3s ease;overflow:hidden}.product:hover{transform:translateY(-8px);box-shadow:0 10px 25px rgba(0,0,0,.12)}.product.promo-highlight{animation:promoGlow 2.5s infinite ease-in-out}.product-image-container{height:220px;padding:15px;display:flex;align-items:center;justify-content:center}.product img{max-width:100%;max-height:100%;object-fit:contain}.product-info{padding:20px;flex-grow:1;display:flex;flex-direction:column;text-align:left;position:relative}.product h3{margin:0 0 10px;font-size:1.25rem;height:3.75rem;overflow:hidden}.product .benefits{font-size:.85rem;color:#555;margin:10px 0;flex-grow:1}.product .consumption{font-size:.85rem;color:var(--primary-color);font-style:italic;margin:10px 0}.price-section{margin:15px 0;text-align:center}.original-price{text-decoration:line-through;color:#999;font-size:1rem;margin-right:10px}.new-price{color:var(--secondary-color);font-weight:700;font-size:1.5rem}.product-points{font-size:.9rem;font-weight:600;color:var(--accent-color);text-align:center;margin-top:10px}.product-actions{margin-top:auto;display:flex;flex-direction:column;gap:10px}.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:12px 15px;border-radius:50px;text-decoration:none;font-weight:700;border:none;cursor:pointer;transition:all .3s}.btn:disabled{background-color:#ccc;cursor:not-allowed}.btn-primary{background:var(--primary-color);color:var(--light-text)}.btn-primary:hover{background:#123e5a;transform:scale(1.05)}.btn-secondary{background:var(--light-gray);color:var(--primary-color);border:1px solid var(--primary-color)}.btn-secondary:hover{background:#e0e0e0}.featured-badge{position:absolute;top:0;right:0;background:var(--secondary-color);color:#fff;padding:5px 25px;transform:rotate(45deg) translate(25%,-65%);transform-origin:0 0;font-weight:700;font-size:.9rem;box-shadow:0 3px 10px rgba(0,0,0,.2);z-index:10;white-space:nowrap}.halal-badge{position:absolute;top:10px;left:10px;background-color:rgba(255,255,255,0.8);color:var(--accent-color);padding:3px 8px;border-radius:5px;font-size:.75rem;font-weight:700;border:1px solid rgba(39,174,96,0.3)}.floating-cart-btn{position:fixed;bottom:20px;right:20px;width:60px;height:60px;background-color:var(--primary-color);color:var(--light-text);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.8rem;box-shadow:0 4px 12px rgba(0,0,0,.25);cursor:pointer;z-index:1000;transition:transform .3s ease}.floating-cart-btn:hover{transform:scale(1.1)}#cart-count{position:absolute;top:-2px;right:-2px;background-color:var(--secondary-color);color:var(--light-text);border-radius:50%;padding:3px 8px;font-size:.8rem;font-weight:700;border:2px solid var(--light-text)}.modal{display:none;position:fixed;z-index:1001;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);align-items:center;justify-content:center;animation:fadeIn .4s ease}.modal-content{background-color:#fefefe;padding:30px;border-radius:var(--border-radius);width:90%;max-width:600px;animation:slideIn .4s ease;max-height:90vh;overflow-y:auto}.close{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer;transition:color .3s}.close:hover{color:#000}#cart-items{max-height:250px;overflow-y:auto;padding-right:10px;border-bottom:1px solid #eee;margin-bottom:15px}.cart-item{display:flex;justify-content:space-between;align-items:center;padding:10px 0}.cart-item-details{flex-grow:1}.quantity-controls{display:flex;align-items:center;gap:8px;margin-top:5px}.quantity-btn{width:28px;height:28px;background:var(--light-gray);border:1px solid #ccc;border-radius:50%;cursor:pointer;font-weight:700}.quantity-display{font-weight:600;min-width:20px;text-align:center}.remove-item-btn{font-size:1.2rem;color:#c00;cursor:pointer;margin-left:15px}.cart-summary{margin-top:20px;font-size:1.1rem}.summary-line{display:flex;justify-content:space-between;padding:8px 0}.summary-line.total{font-weight:700;font-size:1.3rem;border-top:2px solid #333;margin-top:10px}.points-earned,.free-shipping-promo{background-color:#e0f2f1;color:var(--accent-color);padding:10px;border-radius:8px;text-align:center;margin-top:20px;font-weight:700}.customer-info-form input{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:5px}.discount-section{display:flex;gap:10px;margin-top:15px}.discount-section input{flex-grow:1;padding:10px;border:1px solid #ccc;border-radius:5px}.discount-section button{width:auto;padding:10px 15px;flex-shrink:0}#discount-status{font-size:.9rem;font-weight:600;margin-top:8px;min-height:18px;text-align:center}#consent-form{margin-top:20px;padding:15px;background-color:#f8f9fa;border:1px solid #dee2e6;border-radius:8px;font-size:.9rem}#consent-form label{display:flex;align-items:flex-start;gap:10px}#consent-form input[type=checkbox]{margin-top:3px}#consent-form a{color:var(--primary-color);font-weight:600}.checkout-btn{width:100%;margin-top:15px}.verification-step{margin-top:20px;padding:20px;background-color:var(--light-gray);border-radius:var(--border-radius);text-align:center;border:2px dashed #ddd}.verification-step.active{border-color:var(--primary-color);background-color:#eaf2f8}.verification-step.completed{border-color:var(--accent-color);background-color:#e8f8f5;opacity:.7}.verification-step h4{margin-top:0}.verification-step input[type=file],.verification-step input[type=text]{width:100%;padding:12px;margin:15px 0 10px;border:1px solid #ddd;border-radius:8px}#upload-status,#verification-status{margin-top:10px;font-weight:700;min-height:20px}footer{background:var(--primary-color);color:var(--light-text);padding:40px 20px;text-align:center;margin-top:30px}.disclaimer{margin-top:10px;background-color:#fff3cd;color:#856404;padding:15px;border-top:1px solid #ffeeba}
    .about-us-section{padding:40px;background-color:#fff;border-radius:var(--border-radius);box-shadow:var(--shadow)}.about-us-section .owner-profile{display:flex;align-items:center;gap:30px;flex-wrap:wrap}.about-us-section .owner-image{width:150px;height:150px;border-radius:50%;object-fit:cover;border:5px solid var(--primary-color)}.about-us-section .owner-details{flex:1;min-width:300px}.about-us-section ul {list-style: none; padding-left: 0;} .about-us-section ul li {margin-bottom: 10px;} .feedback-form select{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:5px} .feedback-form textarea{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:5px;min-height:120px} #feedback-status{font-weight:bold;margin-top:15px;}
    .program-section{background:var(--light-text);padding:40px;border-radius:var(--border-radius);box-shadow:var(--shadow);margin-bottom:30px}.program-section h2{font-size:2.5rem;text-align:center}.program-section ul {list-style: none; padding-left: 0; margin-top: 30px;}.program-section ul li {background: #f9f9f9; border-left: 5px solid var(--accent-color); padding: 15px; margin-bottom: 10px; border-radius: 5px; text-align: left;}.program-section ul li strong {color: var(--primary-color); display: block; margin-bottom: 5px;}
    .cta-button{display:block;width:fit-content;margin:30px auto;background:linear-gradient(135deg,var(--secondary-color),#e67e22);color:var(--light-text);text-align:center;padding:15px 40px;border-radius:50px;font-weight:700;text-decoration:none;font-size:1.2rem;transition:all .3s;box-shadow:0 4px 8px rgba(0,0,0,.2)}.cta-button:hover{transform:translateY(-3px);box-shadow:0 6px 12px rgba(0,0,0,.3)}.rewards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px}.reward-item{background:var(--light-gray);border:1px solid #ddd;border-radius:var(--border-radius);padding:20px;text-align:center;display:flex;flex-direction:column;position:relative}.reward-item img{max-width:100%;max-height:100px;object-fit:contain;margin-bottom:15px;border-radius:8px}.reward-item h4{margin:10px 0 5px}.reward-item .points-cost{font-weight:700;color:var(--accent-color);margin-bottom:15px}.coming-soon-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(255,255,255,.8);color:var(--primary-color);display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;border-radius:var(--border-radius);backdrop-filter:blur(2px)}
    .original-cart-price{text-decoration:line-through;color:#999;font-size:.9rem;}.final-cart-price{font-weight:600}.summary-line small{font-size:.8rem;color:var(--accent-color);font-style:italic}
  </style>

  <!-- ======================================================================================= -->
  <!-- ======================= ADVANCED FESTIVAL DECORATIONS CSS (FIXED) ======================= -->
  <!-- ======================================================================================= -->
  <style id="festival-animations-style">
    #festival-animations-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; pointer-events: none; z-index: -1; }
    .festival-element { position: absolute; display: none; background-size: contain; background-repeat: no-repeat; will-change: transform, opacity; }
    .decorative-border { position: fixed; left: 0; width: 100%; height: 150px; background-size: contain; z-index: -1; display: none; }
    .top-border { top: 0; background-repeat: repeat-x; }
    .bottom-border { bottom: 0; background-repeat: repeat-x; }

    /* --- KEYFRAMES --- */
    @keyframes fall { 0% { transform: translateY(-10vh) rotate(-15deg); opacity: 0; } 10% { opacity: 1; } 100% { transform: translateY(105vh) rotate(15deg); opacity: 0; } }
    @keyframes sway { 0%, 100% { transform: rotate(-8deg); } 50% { transform: rotate(8deg); } }
    @keyframes glow { 0%, 100% { filter: drop-shadow(0 0 5px gold) brightness(1.2); } 50% { filter: drop-shadow(0 0 15px gold) brightness(1.8); } }
    @keyframes twinkle { 0% { opacity: 0.3; transform: scale(0.8); } 50% { opacity: 1; transform: scale(1); } 100% { opacity: 0.3; transform: scale(0.8); } }
    @keyframes firework-burst { 0% { transform: scale(0); opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }
    @keyframes dragon-dance { 0% { left: -30%; transform: translateY(0); } 40% { transform: translateY(-30px); } 70% { transform: translateY(10px); } 100% { left: 110%; transform: translateY(0); } }
    @keyframes shoot-star { 0% { transform: translateX(300px) translateY(-300px) scale(0.5); opacity: 0; } 5% { opacity: 1; } 15% { transform: translateX(-300px) translateY(300px) scale(0.5); opacity: 0; } 100% { opacity: 0; } }
    @keyframes peacock-sway { 0%, 100% { transform: translateY(0) rotate(-15deg); } 50% { transform: translateY(-20px) rotate(15deg); } }

    /* --- Grand Opening --- */
    .theme-GrandOpening .confetti, .theme-GrandOpening .popper { display: block; }
    .confetti { width: 12px; height: 18px; animation: fall linear infinite; }
    .confetti-1 { background-color: #ffd700; left: 10%; animation-duration: 4s; animation-delay: 0.5s; }
    .confetti-2 { background-color: #ff6347; left: 25%; animation-duration: 5s; animation-delay: 1s; }
    .confetti-3 { background-color: #3498db; left: 40%; animation-duration: 3s; animation-delay: 2s; }
    .confetti-4 { background-color: #2ecc71; left: 60%; animation-duration: 6s; animation-delay: 0.2s; }
    .confetti-5 { background-color: #ffffff; left: 75%; animation-duration: 4.5s; animation-delay: 3s; }
    .confetti-6 { background-color: #f1c40f; left: 90%; animation-duration: 5.5s; animation-delay: 1.5s; }
    .popper { width: 150px; height: 150px; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20 100 L50 70 L80 100 Z" fill="%23e74c3c"/><path d="M50 70 L20 0 L80 0 Z" fill="%23f1c40f"/><circle cx="30" cy="20" r="5" fill="white"/><circle cx="50" cy="30" r="5" fill="white"/><circle cx="70" cy="20" r="5" fill="white"/></svg>'); animation: firework-burst 2s ease-out infinite; }
    .popper-1 { bottom: -50px; left: 5%; animation-delay: 1s; }
    .popper-2 { bottom: -50px; right: 5%; animation-delay: 2.5s; }

    /* --- Hari Raya --- */
    .theme-HariRaya body { background-image: linear-gradient(to top, #001a00, #004d00); color: white; }
    .theme-HariRaya .decorative-border, .theme-HariRaya .star, .theme-HariRaya .mosque { display: block; }
    .theme-HariRaya .bottom-border { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><path d="M0 20 Q 25 0, 50 20 T 100 20" fill="rgba(255, 215, 0, 0.2)"/></svg>'); height: 100px; background-size: auto 100px; opacity: 0.5; }
    .mosque { width: 100%; height: 250px; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 200"><path d="M0 200 L800 200 L800 150 C 750 150, 750 100, 700 100 C 650 100, 650 150, 600 150 L600 100 L550 100 Q 525 50, 500 100 L450 100 L450 80 Q 425 0, 400 80 L350 80 L350 100 Q 325 50, 300 100 L250 100 L250 150 C 200 150, 200 100, 150 100 C 100 100, 100 150, 50 150 L0 150 Z" fill="rgba(0, 50, 0, 0.7)"/></svg>'); background-size: cover; background-position: center bottom; bottom: 0; left:0; }
    .star { background-color: white; border-radius: 50%; animation: twinkle infinite; box-shadow: 0 0 10px white; }
    .star-1 { width: 2px; height: 2px; top: 10%; left: 15%; animation-duration: 3s; } .star-2 { width: 3px; height: 3px; top: 20%; left: 80%; animation-duration: 2s; } .star-3 { width: 2px; height: 2px; top: 50%; left: 50%; animation-duration: 4s; } .star-4 { width: 3px; height: 3px; top: 70%; left: 25%; animation-duration: 2.5s; } .star-5 { width: 2px; height: 2px; top: 30%; left: 95%; animation-duration: 3.5s; }

    /* --- Deepavali --- */
    .theme-Deepavali body { background-image: linear-gradient(to top, #4a1833, #8c2f6b); }
    .theme-Deepavali .decorative-border, .theme-Deepavali .peacock-feather, .theme-Deepavali .sparkle { display: block; }
    .theme-Deepavali .top-border { height: 80px; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 50"><g fill="%23f39c12"><circle cx="10" cy="10" r="8"/><path d="M10 18 V 40"/><circle cx="10" cy="40" r="5" fill="%23e74c3c"/></g><g fill="%23f39c12" transform="translate(40,0)"><circle cx="10" cy="10" r="8"/><path d="M10 18 V 40"/><circle cx="10" cy="40" r="5" fill="%23e74c3c"/></g><g fill="%23f39c12" transform="translate(80,0)"><circle cx="10" cy="10" r="8"/><path d="M10 18 V 40"/><circle cx="10" cy="40" r="5" fill="%23e74c3c"/></g></svg>'); background-size: auto 80px; }
    .peacock-feather { width: 100px; height: 100px; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 100 C 20 70, 20 30, 50 0 C 80 30, 80 70, 50 100 Z" fill="%233498db"/><circle cx="50" cy="50" r="15" fill="%2327ae60"/><circle cx="50" cy="50" r="5" fill="%238e44ad"/></svg>'); animation: peacock-sway 10s ease-in-out infinite; }
    .peacock-1 { top: 15%; left: 5%; animation-duration: 12s; } .peacock-2 { top: 40%; right: -2%; animation-duration: 15s; animation-delay: 2s; }
    .sparkle { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 0 L60 40 L100 50 L60 60 L50 100 L40 60 L0 50 L40 40 Z" fill="gold"/></svg>'); animation: twinkle 2s infinite; }
    .sparkle-1 { width: 20px; height: 20px; top: 25%; left: 40%; } .sparkle-2 { width: 30px; height: 30px; top: 60%; left: 80%; animation-delay: 1s; } .sparkle-3 { width: 25px; height: 25px; top: 80%; left: 10%; animation-delay: 0.5s; }

    /* --- Christmas --- */
    .theme-Christmas body { background-image: linear-gradient(to top, #001a33, #003366); }
    .theme-Christmas .lights, .theme-Christmas .shooting-star, .theme-Christmas .snowflake { display: block; }
    .lights { width: 100%; height: 50px; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 50"><path d="M0 20 C 25 40, 75 0, 100 20" stroke="gray" fill="none"/><circle cx="25" cy="30" r="5" fill="red" class="light-1"/><circle cx="50" cy="10" r="5" fill="green" class="light-2"/><circle cx="75" cy="25" r="5" fill="blue" class="light-3"/><style>.light-1{animation:light-blink 3s infinite .5s}.light-2{animation:light-blink 3s infinite 1s}.light-3{animation:light-blink 3s infinite 1.5s}@keyframes light-blink{50%{opacity:0.2}}</style></svg>'); top: 0; left: 0; background-size: 150px 50px; background-repeat: repeat-x; }
    .shooting-star { width: 100px; height: 2px; background: linear-gradient(to left, white, transparent); border-radius: 50%; top: 20%; left: -300px; animation: shoot-star 10s linear infinite; animation-delay: 3s; filter: drop-shadow(0 0 6px white); }
    .snowflake { animation-name: fall; background-image: url('https://svgshare.com/i/18ar.svg'); opacity: 0.7; }
    .snowflake-1 { width: 30px; height: 30px; left: 10%; animation-duration: 12s; } .snowflake-2 { width: 40px; height: 40px; left: 30%; animation-duration: 8s; animation-delay: 3s; } .snowflake-3 { width: 25px; height: 25px; left: 50%; animation-duration: 15s; animation-delay: 1s; } .snowflake-4 { width: 35px; height: 35px; left: 70%; animation-duration: 9s; animation-delay: 5s; } .snowflake-5 { width: 30px; height: 30px; left: 90%; animation-duration: 11s; animation-delay: 2s; }

    /* --- CNY --- */
    .theme-CNY body { background-image: linear-gradient(to top, #5c0000, #a30000); }
    .theme-CNY .cherry-blossom, .theme-CNY .dragon, .theme-CNY .lantern { display: block; }
    .cherry-blossom { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23ffb6c1"/><circle cx="50" cy="50" r="10" fill="white"/></svg>'); animation: fall 15s linear infinite; }
    .cb-1 { width: 15px; height: 15px; left: 5%; animation-duration: 10s; } .cb-2 { width: 20px; height: 20px; left: 25%; animation-duration: 12s; animation-delay: 3s; } .cb-3 { width: 15px; height: 15px; left: 45%; animation-duration: 8s; animation-delay: 1s; } .cb-4 { width: 20px; height: 20px; left: 65%; animation-duration: 14s; animation-delay: 5s; } .cb-5 { width: 15px; height: 15px; left: 85%; animation-duration: 9s; animation-delay: 2s; }
    .dragon { width: 300px; height: 150px; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200"><path d="M50 150 C 100 50, 200 50, 250 150 S 350 250, 400 150" fill="none" stroke="%23f1c40f" stroke-width="10"/><path d="M50 150 C 40 130, 20 120, 10 150 C 20 180, 40 170, 50 150" fill="%23c0392b"/></svg>'); bottom: 20px; animation: dragon-dance 20s linear infinite; opacity: 0.8; }
    .lantern { background-image: url('https://svgshare.com/i/18bM.svg'); animation: sway 8s ease-in-out infinite; filter: drop-shadow(0 0 15px #c0392b); }
    .lantern-1 { width: 120px; height: 120px; top: 2%; left: 10%; } .lantern-2 { width: 100px; height: 100px; top: 5%; right: 5%; animation-delay: 1.5s; }

    /* --- National/Malaysia Day --- */
    .theme-NationalDay body, .theme-MalaysiaDay body { background: linear-gradient(to top, #000033, #000066, #cc0000, #ffcc00); }
    .theme-NationalDay .landmark, .theme-MalaysiaDay .landmark, .theme-NationalDay .firework-my, .theme-MalaysiaDay .firework-my { display: block; }
    .landmark { width: 100%; height: 300px; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 300"><path d="M100 300 L120 100 L140 300 Z M200 300 L220 50 L240 300 Z M 220 50 Q 280 0 340 50 L360 300 L320 300 Z M 500 300 L500 100 L 550 50 L 600 100 L 600 300 Z" fill="rgba(0,0,0,0.4)"/></svg>'); bottom: 0; left: 0; background-size: cover; background-position: center bottom; }
    .firework-my { background-image: url('https://svgshare.com/i/18c7.svg'); animation-name: firework-burst; }
    .firework-my-1 { width: 250px; height: 250px; top: 10%; left: 15%; animation-duration: 3s; animation-delay: 1s; }
    .firework-my-2 { width: 300px; height: 300px; top: 20%; right: 10%; animation-duration: 3s; animation-delay: 2.5s; }
    .firework-my-3 { width: 200px; height: 200px; top: 40%; left: 40%; animation-duration: 3s; animation-delay: 4s; }
  </style>
</head>
<body class="default-theme">

<!-- This is the container for the festive animations -->
<div id="festival-animations-container">
    <!-- Decorative Borders -->
    <div class="decorative-border top-border"></div>
    <div class="decorative-border bottom-border"></div>

    <!-- Grand Opening -->
    <div class="festival-element confetti confetti-1"></div><div class="festival-element confetti confetti-2"></div><div class="festival-element confetti confetti-3"></div><div class="festival-element confetti confetti-4"></div><div class="festival-element confetti confetti-5"></div><div class="festival-element confetti confetti-6"></div>
    <div class="festival-element popper popper-1"></div><div class="festival-element popper popper-2"></div>
    
    <!-- Hari Raya -->
    <div class="festival-element star star-1"></div><div class="festival-element star star-2"></div><div class="festival-element star star-3"></div><div class="festival-element star star-4"></div><div class="festival-element star star-5"></div>
    <div class="festival-element mosque"></div>

    <!-- Deepavali -->
    <div class="festival-element peacock-feather peacock-1"></div><div class="festival-element peacock-feather peacock-2"></div>
    <div class="festival-element sparkle sparkle-1"></div><div class="festival-element sparkle sparkle-2"></div><div class="festival-element sparkle sparkle-3"></div>
    
    <!-- Christmas -->
    <div class="festival-element lights"></div><div class="festival-element shooting-star"></div>
    <div class="festival-element snowflake snowflake-1"></div><div class="festival-element snowflake snowflake-2"></div><div class="festival-element snowflake snowflake-3"></div><div class="festival-element snowflake snowflake-4"></div><div class="festival-element snowflake snowflake-5"></div>
    
    <!-- CNY -->
    <div class="festival-element lantern lantern-1"></div><div class="festival-element lantern lantern-2"></div>
    <div class="festival-element cherry-blossom cb-1"></div><div class="festival-element cherry-blossom cb-2"></div><div class="festival-element cherry-blossom cb-3"></div><div class="festival-element cherry-blossom cb-4"></div><div class="festival-element cherry-blossom cb-5"></div>
    <div class="festival-element dragon"></div>
    
    <!-- National/Malaysia Day -->
    <div class="festival-element landmark"></div>
    <div class="festival-element firework-my firework-my-1"></div><div class="festival-element firework-my firework-my-2"></div><div class="festival-element firework-my firework-my-3"></div>
</div>

<div id="store-wrapper">
  <header>
    <div class="container">
        <div class="header-content">
            <img src="FL.jpg" alt="Business Logo" class="header-logo" onerror="this.style.display='none'">
            <h1>
              FOREVER LIVING by Muhd Arvind Isa
              <span style="font-size: 1rem; color: #555; display: block; font-weight: 400;">Quality Wellness Products</span>
            </h1>
        </div>
    </div>
  </header>
  
  <div id="promo-running-banner">
      <div class="marquee-content" id="promo-banner-text"></div>
  </div>

  <nav>
    <div class="container">
        <ul id="main-nav">
          <li><a onclick="showTab('products')">Products</a></li>
          <li><a onclick="showTab('business')">Business Opportunity</a></li>
          <li><a onclick="showTab('about')">About Us</a></li>
          <li><a class="nav-disabled">Rewards</a></li>
          <li><a class="nav-disabled">My Forever Living</a></li>
        </ul>
    </div>
  </nav>

  <main id="main-content" class="container">
    <div id="products" class="tab-content active">
      <section class="hero-section" id="hero-section">
        <h2 id="hero-title"><i class="fa-solid fa-store"></i> Welcome to Our Store</h2>
        <p id="hero-subtitle">Enjoy high-quality wellness products for a healthier lifestyle.</p>
        <div id="countdown-timer" style="display:none;"></div>
      </section>

      <div class="search-container">
        <input type="text" id="product-search" onkeyup="filterProducts()" placeholder="Search for products by name...">
        <i class="fa-solid fa-search search-icon"></i>
      </div>

      <section class="ai-suggestion-box">
        <h3><i class="fa-solid fa-robot"></i> AI Product Suggester</h3>
        <p>Describe your health concern (e.g., "dry skin", "low energy") and our AI will suggest a product for you.</p>
        <input type="text" id="symptom-input" placeholder="Enter your symptom or concern...">
        <button id="suggest-btn" class="btn btn-primary" onclick="suggestProduct()">Get Suggestion</button>
        <div id="suggestion-result"></div>
      </section>

      <div id="product-list-container">
          <p style="text-align: center; width: 100%;">
            <i class="fa-solid fa-spinner fa-spin"></i> Loading products from our catalog...
          </p>
      </div>
    </div>

    <div id="business" class="tab-content">
      <section class="program-section">
        <h2>Build Your Forever Business</h2>
        <p style="text-align: center; max-width: 800px; margin: 20px auto;">The Forever Living opportunity is more than just selling high-quality products; it's a chance to build a flexible, rewarding business on your own terms. Whether you're looking for extra income or a full-time career, Forever provides a proven path to success.</p>
        <h3 style="margin-top:40px;">How Does It Work?</h3>
        <ul>
            <li><strong>Become Your Own Boss:</strong> As a Forever Business Owner (FBO), you have the freedom to work from anywhere, set your own hours, and grow at your own pace. There are no large startup fees or required inventory purchases.</li>
            <li><strong>A Simple, Proven Model:</strong> The business is built on a simple cycle: Use the products yourself, share your experience and the products with others, and build a team of like-minded individuals to do the same.</li>
            <li><strong>Earn Generous Rewards:</strong> You earn income from your retail sales and from the sales of your team members. Forever offers one of the most generous compensation plans in the industry, including performance bonuses, the car plan (Earn While you Drive), and global travel incentives.</li>
            <li><strong>World-Class Support:</strong> You are never alone. You will receive mentorship, training materials, and support from our team at Rich Academy Global and the wider Forever community to help you achieve your goals.</li>
        </ul>
        <h3 style="margin-top:40px;">Ready to Start Your Journey?</h3>
        <p style="text-align: center;">Take the first step towards a healthier, wealthier life. Contact us today to learn more without any obligation.</p>
        <a href="https://wa.me/601111033154?text=Hi,%20I'm%20interested%20in%20learning%20more%20about%20the%20Forever%20Living%20business%20opportunity." class="cta-button" target="_blank"><i class="fab fa-whatsapp"></i> Click to Learn More on WhatsApp</a>
      </section>
    </div>

    <div id="about" class="tab-content">
      <section class="about-us-section">
        <h2>About Us</h2>
        <div class="owner-profile">
            <img src="owner.jpg" alt="Muhd Arvind Isa" class="owner-image" onerror="this.src='https://via.placeholder.com/150'">
            <div class="owner-details">
                <h3>Muhd Arvind Isa - Independent FBO</h3>
                <p>Welcome! I am an authorized Independent Forever Business Owner (FBO) dedicated to bringing you the highest quality health and wellness products from Forever Living. My mission is to empower individuals to lead healthier lives and to provide opportunities for financial well-being through the Forever business model.</p>
                <p><strong>Powered by:</strong> Rich Academy Global</p>
                <p><strong>Contact Information:</strong></p>
                <ul>
                    <li><strong><i class="fab fa-whatsapp"></i> WhatsApp:</strong> <a href="https://wa.me/601111033154">+6011 1103 3154</a></li>
                    <li><strong><i class="fa fa-envelope"></i> Email:</strong> <a href="mailto:cs.foreverlivingbymuhdarvindisa@gmail.com">cs.foreverlivingbymuhdarvindisa@gmail.com</a></li>
                </ul>
            </div>
        </div>
        <hr style="margin: 30px 0;">
        <h3>The Forever Living Legacy</h3>
        <p>Founded in 1978 by Rex Maughan, Forever Living Products is a multi-billion dollar company that manufactures and sells hundreds of wellness and beauty products all around the world. What makes Forever unique is its commitment to quality through a process called "from seed to product."</p>
        <ul>
            <li><strong>The Aloe Vera Company:</strong> Forever owns its own aloe vera plantations in Texas and the Dominican Republic, ensuring the purest and most potent aloe is used in its products. They control the entire process, from planting and harvesting to processing and manufacturing.</li>
            <li><strong>Global Presence:</strong> For over 40 years, Forever has grown to operate in more than 160 countries, demonstrating the universal appeal and effectiveness of its products and business model.</li>
            <li><strong>Our Commitment:</strong> We are committed to providing authentic Forever Living products, exceptional customer service, and reliable support for both our customers and business partners. All products are sourced directly from Forever Living Products and are guaranteed to be genuine.</li>
        </ul>
        <hr style="margin: 30px 0;">
        <h3>Feedback & Order Requests</h3>
        <p>Have a question, compliment, or suggestion? Or perhaps you'd like to place an order directly? Fill out the form below, and we'll get back to you as soon as possible.</p>
        <form class="feedback-form" onsubmit="sendFeedbackEmail(event)">
            <input type="text" id="feedback-name" placeholder="Your Name" required>
            <input type="email" id="feedback-email" placeholder="Your Email" required>
            <select id="feedback-subject" required>
                <option value="" disabled selected>Select a Subject...</option>
                <option value="General Enquiry">General Enquiry</option>
                <option value="Order Request">Order Request</option>
                <option value="Compliment">Compliment</option>
                <option value="Complaint">Complaint</option>
                <option value="Suggestion">Suggestion</option>
            </select>
            <textarea id="feedback-message" placeholder="Your Message" required></textarea>
            <button type="submit" id="feedback-submit-btn" class="btn btn-primary">Send Message</button>
            <p id="feedback-status"></p>
        </form>
      </section>
    </div>

    <div id="rewards" class="tab-content">
      <section class="program-section">
            <h2><i class="fa-solid fa-award"></i> Redeem Your Points</h2>
            <p style="text-align: center;">This feature is currently under development. Stay tuned for exciting rewards!</p>
            <div class="rewards-grid">
                <div class="reward-item">
                    <img src="rm5.jpg" alt="RM 5 Voucher" onerror="this.src='https://i.imgur.com/O9yP2aH.png'">
                    <h4>RM 5 Voucher</h4><p class="points-cost">500 Points</p><div class="coming-soon-overlay"><span>Coming Soon</span></div>
                </div>
                <div class="reward-item">
                    <img src="rm10.jpg" alt="RM 10 Voucher" onerror="this.src='https://i.imgur.com/sY2a2qG.png'">
                    <h4>RM 10 Voucher</h4><p class="points-cost">1000 Points</p><div class="coming-soon-overlay"><span>Coming Soon</span></div>
                </div>
            </div>
        </section>
    </div>
  </main>

  <footer class="footer">
      <div class="container">
        <p>© 2025 Forever Living by Muhd Arvind Isa. All rights reserved.</p>
        <div class="timestamp">Last updated: <span id="update-timestamp"></span></div>
        <section class="disclaimer">
          <strong>Disclaimer:</strong> This website is operated by an independent FBO and is not the official site of Forever Living Products.
        </section>
      </div>
  </footer>
</div>

  <div id="floating-cart" class="floating-cart-btn" onclick="toggleCart()">
    <i class="fa-solid fa-cart-shopping"></i>
    <span id="cart-count">0</span>
  </div>

  <div id="cart-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="toggleCart(true)">×</span>
      <div id="cart-view">
        <h2>Your Shopping Cart</h2>
        <div id="cart-items"><p>Your cart is currently empty.</p></div>
        <div class="cart-summary">
          <div class="summary-line"><span>Subtotal</span><span id="cart-subtotal">RM 0.00</span></div>
          <div class="summary-line" id="discount-line" style="display:none;"><span>Discount</span><span id="cart-discount">RM 0.00</span></div>
          <div class="summary-line"><span>Shipping</span><span id="cart-shipping">RM 0.00</span></div>
          <div class="summary-line" id="savings-line" style="display:none; color: var(--accent-color); font-weight: bold;"><span>You Saved</span><span id="cart-savings">RM 0.00</span></div>
          <div class="summary-line total"><span>Total</span><span id="cart-total">RM 0.00</span></div>
          <div id="points-earned-display"></div>
        </div>
        <div class="discount-section">
            <input type="text" id="discount-code-input" placeholder="Enter Discount Code">
            <button class="btn btn-secondary" onclick="applyDiscount()">Apply</button>
        </div>
        <p id="discount-status"></p>
        <div class="customer-info-form">
          <h3 style="margin-top: 20px;">Customer & Shipping Information</h3>
          <input type="text" id="customer-name" placeholder="Your Full Name" required>
          <input type="tel" id="customer-phone" placeholder="Your WhatsApp Number (e.g., 60123456789)" required>
          <input type="email" id="customer-email" placeholder="Your Email Address (for receipt)" required>
          <input type="text" id="customer-address1" placeholder="Address Line 1" required>
          <input type="text" id="customer-address2" placeholder="Address Line 2 (Optional)">
          <input type="text" id="customer-city" placeholder="City" required>
          <input type="text" id="customer-state" placeholder="State" required>
          <input type="text" id="customer-postcode" placeholder="Postcode" required>
        </div>
        <div id="consent-form">
            <label for="consent-checkbox">
                <input type="checkbox" id="consent-checkbox" onchange="toggleCheckoutButton()">
                <span>I consent to the collection of my personal data for transaction purposes. You can request data deletion at any time via <a href="https://wa.me/601111033154?text=Hi,%20I%20would%20like%20to%20request%20my%20personal%20data%20to%20be%20deleted." target="_blank">WhatsApp</a> or <a href="mailto:cs.foreverlivingbymuhdarvindisa@gmail.com?subject=Request%20for%20Data%20Deletion">Email</a>.</span>
            </label>
        </div>
        <button class="btn btn-primary checkout-btn" id="checkout-btn" onclick="initiateCheckout()" disabled>Agree & Complete Order via WhatsApp</button>
      </div>
      <div id="verification-view" style="display: none;">
        <h2>Order Verification</h2>
        <p>Please complete the following steps to finalize your order.</p>
        <div id="proof-upload-step" class="verification-step active">
            <h4><i class="fa-solid fa-arrow-up-from-bracket"></i> Step 1: Upload Payment Proof</h4>
            <p style="font-size: 0.9rem; color: #555;">Upload a screenshot of your transaction receipt.</p>
            <input type="file" id="payment-proof-upload" accept="image/*">
            <button class="btn btn-primary" id="upload-proof-btn" onclick="uploadProof()">Upload and Proceed</button>
            <p id="upload-status"></p>
        </div>
        <div id="code-verification-step" class="verification-step">
            <h4><i class="fa-solid fa-key"></i> Step 2: Finalize with Code</h4>
            <p style="font-size: 0.9rem; color: #555;">Enter the verification code provided to you by the owner.</p>
            <input type="text" id="verification-code" placeholder="Enter Verification Code" disabled>
            <button class="btn btn-primary" id="finalize-order-btn" onclick="finalizeOrder()" disabled>Finalize Order & Get Receipt</button>
            <p id="verification-status"></p>
        </div>
        <button class="btn btn-secondary" style="margin-top: 20px;" onclick="cancelVerification()">Cancel Entire Order</button>
      </div>
    </div>
  </div>

<script>
    // This is the full, working JavaScript. No changes are needed here.
    const googleScriptURL = 'https://script.google.com/macros/s/AKfycbzbjr5QZCpdf5mzT4nTM6CMl5P5zgyrggDGpiKnXNipx9iCVC_Y3g_aNPrXeuLFKmP1gw/exec';
    let products = []; let cart = []; let activeFestival = null; let activePromotions = [];
    let shippingRules = {}; let availableDiscountCodes = {}; let appliedDiscount = null;
    document.addEventListener('DOMContentLoaded', fetchData);
    async function fetchData() {
        const productListContainer = document.getElementById("product-list-container");
        try {
            const response = await fetch(googleScriptURL);
            if (!response.ok) throw new Error(`Network response was not ok: ${response.statusText}`);
            const data = await response.json();
            if (data.status === 'success') {
                products = data.products || []; activeFestival = data.activeFestival || null;
                activePromotions = data.activePromotions || []; shippingRules = data.shippingRules || {};
                availableDiscountCodes = data.discountCodes || {}; initializeUI();
            } else { throw new Error(data.message || 'Failed to parse data from the server.'); }
        } catch (error) {
            console.error("Error fetching store data:", error);
            if (productListContainer) {
                productListContainer.innerHTML = `<p style="text-align: center; color: red; font-weight: bold; width: 100%; padding: 40px 0;"><i class="fa-solid fa-triangle-exclamation"></i> Error loading store.<br>The product catalog could not be retrieved. Please try again later.</p>`;
            }
        }
        const version = "(v11.3)";
        const date = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        document.getElementById('update-timestamp').textContent = `${date} ${version}`;
        if (sessionStorage.getItem('pendingOrder')) { toggleCart(); } else { showTab('products'); }
    }
    function initializeUI() {
        const body = document.body; body.className = 'default-theme';
        const festivalContainer = document.getElementById('festival-animations-container');
        if (activeFestival && activeFestival.theme) {
            body.classList.add(`theme-${activeFestival.theme}`);
            document.getElementById('hero-title').innerHTML = `<i class="fa-solid fa-gift"></i> ${activeFestival.name}`;
            document.getElementById('hero-subtitle').textContent = "Enjoy special festive offers!";
            const banner = document.getElementById('promo-running-banner');
            document.getElementById('promo-banner-text').textContent = `✨ ${activeFestival.name}! See special offers below! ✨`;
            banner.style.display = 'block'; startCountdown(activeFestival.endDate);
            if(festivalContainer) festivalContainer.style.display = 'block';
        } else {
            document.getElementById('hero-title').innerHTML = `<i class="fa-solid fa-store"></i> Welcome to Our Store`;
            document.getElementById('hero-subtitle').textContent = "Enjoy high-quality wellness products for a healthier lifestyle.";
            if(festivalContainer) festivalContainer.style.display = 'none';
        }
        renderProducts();
    }
    function renderProducts(){
        const productListContainer = document.getElementById("product-list-container"); if (!productListContainer) return;
        if (products.length === 0) { productListContainer.innerHTML = `<p style="text-align: center; width: 100%;">No products found in the catalog.</p>`; return; }
        let html = ""; let remainingProducts = [...products];
        if (activePromotions && activePromotions.length > 0) {
            activePromotions.forEach(promo => {
                let productsInPromo = [];
                remainingProducts.forEach(p => { if (promo.productIDs && promo.productIDs.includes(p.id)) { productsInPromo.push(p); } });
                if (productsInPromo.length > 0) {
                    html += `<section class="promo-section"><h2>${promo.description}</h2><div class="product-list">`;
                    productsInPromo.forEach(product => { html += renderSingleProduct(product, promo); });
                    html += `</div></section>`;
                    remainingProducts = remainingProducts.filter(p => !promo.productIDs.includes(p.id));
                }
            });
        }
        if (remainingProducts.length > 0) {
            html += `<section class="promo-section"><h2>All Products</h2><div class="product-list">`;
            remainingProducts.forEach(product => { html += renderSingleProduct(product, null); });
            html += `</div></section>`;
        }
        productListContainer.innerHTML = html;
    }
    function renderSingleProduct(product, promo) {
        let priceHTML = `<span class="new-price">RM ${product.price.toFixed(2)}</span>`;
        let finalPrice = product.price;
        if (promo) {
            if (promo.type === 'PERCENT') {
                const discountedPrice = product.price * (1 - parseFloat(promo.value) / 100);
                priceHTML = `<span class="original-price">RM ${product.price.toFixed(2)}</span><span class="new-price">RM ${discountedPrice.toFixed(2)}</span>`;
                finalPrice = discountedPrice;
            } else if (promo.type === 'FIXED') {
                const discountedPrice = product.price - parseFloat(promo.value);
                priceHTML = `<span class="original-price">RM ${product.price.toFixed(2)}</span><span class="new-price">RM ${discountedPrice.toFixed(2)}</span>`;
                finalPrice = discountedPrice;
            }
        }
        return `<div class="product ${promo ? 'promo-highlight' : ''}"><div class="halal-badge">HALAL</div>${promo ? '<div class="featured-badge">On Offer!</div>' : ''}<div class="product-image-container"><img src="${product.image || 'https://via.placeholder.com/200'}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/200x200?text=Image+Not+Found'"></div><div class="product-info"><h3>${product.name}</h3><div class="price-section">${priceHTML}</div><div class="benefits"><strong>Benefits:</strong> ${product.benefits}</div><div class="consumption"><strong>Usage:</strong> ${product.consumption}</div><div class="product-actions"><button class="btn btn-primary" onclick="addToCart(${product.id}, ${finalPrice})"><i class="fa-solid fa-cart-plus"></i> Add to Cart</button></div></div></div>`;
    }
    function startCountdown(endDateString){const c=document.getElementById("countdown-timer");if(!c||!endDateString)return;c.style.display="inline-block";const p=(new Date(endDateString)).getTime(),i=setInterval(()=>{const n=(new Date).getTime(),d=p-n;if(d<0)return clearInterval(i),void(c.innerHTML="PROMOTION ENDED");const a=Math.floor(d/864e5),o=Math.floor(d%864e5/36e5),s=Math.floor(d%36e5/6e4),t=Math.floor(d%6e4/1e3);c.innerHTML=`${a}d ${o}h ${s}m ${t}s`},1e3)}
    function showTab(t){document.querySelectorAll(".tab-content").forEach(e=>e.classList.remove("active"));const e=document.getElementById(t);e&&e.classList.add("active")}
    function toggleCheckoutButton(){document.getElementById("checkout-btn").disabled=!document.getElementById("consent-checkbox").checked}
    function addToCart(p,f){const e=cart.find(t=>t.id===p);e?e.quantity++:(cart.push({...products.find(t=>t.id===p),quantity:1,finalPrice:f})),updateCartDisplay()}
    function increaseQuantity(p){const t=cart.find(e=>e.id===p);t&&(t.quantity++,updateCartDisplay())}
    function decreaseQuantity(p){const t=cart.find(e=>e.id===p);t&&(t.quantity--,t.quantity<=0?removeItemFromCart(p):updateCartDisplay())}
    function removeItemFromCart(p){appliedDiscount=null,document.getElementById("discount-code-input").value="",document.getElementById("discount-status").textContent="",cart=cart.filter(t=>t.id!==p),updateCartDisplay()}
    function updateCartCount(){document.getElementById("cart-count").textContent=cart.reduce((t,e)=>t+e.quantity,0)}
    function applyDiscount(){const t=document.getElementById("discount-code-input"),e=document.getElementById("discount-status"),o=t.value.trim().toUpperCase();if(!o)return e.textContent="Please enter a code.",void(e.style.color="orange");const n=availableDiscountCodes[o];n?(appliedDiscount={code:o,...n},e.textContent=`Code "${o}" applied successfully!`,e.style.color="green"):(appliedDiscount=null,e.textContent="Invalid or expired discount code.",e.style.color="red"),updateCartDisplay()}
    function calculateCartTotals(){let t=0,e=0,o=null;const n={};const i=cart.map(t=>({...t,details:products.find(e=>e.id===t.id)}));i.forEach(t=>{e+=t.details.price*t.quantity,n[t.id]=t.details.price});activePromotions.forEach(t=>{if(t.shippingRuleId)o=t.shippingRuleId;t.productIDs.forEach(e=>{const r=i.find(t=>t.id===e);if(r){let i=r.details.price;if("PERCENT"===t.type)i*=(1-parseFloat(t.value)/100);else if("FIXED"===t.type)i-=parseFloat(t.value);n[e]=i}})});i.forEach(e=>{t+=n[e.id]*e.quantity});let r=0;if(appliedDiscount){if("Fixed"===appliedDiscount.type)r=parseFloat(appliedDiscount.value);else if("Percentage"===appliedDiscount.type)r=t*(parseFloat(appliedDiscount.value)/100);else if("FreeShipping"===appliedDiscount.type){const t=Object.keys(shippingRules).find(t=>"Free"===shippingRules[t].type);t&&(o=t)}}const a=t-r,s=calculateShipping(cart,a,o),d=a+s.fee,c=Math.floor(a);return{subtotal:t,originalSubtotal:e,discountValue:r,shipping:s,total:d,totalPoints:c,itemFinalPrices:n}}
    function calculateShipping(t,e,o){if(0===t.length)return{fee:0,message:"RM 0.00"};let r=null;if(o&&shippingRules[o])r={...shippingRules[o],reason:"Promotional Shipping!"};else{const t=Object.values(shippingRules).filter(t=>t.isDefault&&"Tiered"===t.type).sort((t,e)=>t.minSpend-e.minSpend);for(const o of t)if(e>=o.minSpend&&e<=o.maxSpend){r={...o,reason:`Spend over RM${o.minSpend}`}}}if(!r)return{fee:14,message:"RM 14.00"};if("Free"===r.type)return{fee:0,message:"FREE",reason:r.reason||"Promotional Free Shipping!"};if("FlatRate"===r.type)return{fee:parseFloat(r.charge),message:`RM ${parseFloat(r.charge).toFixed(2)}`};if("Tiered"===r.type){const t=parseFloat(r.charge);return{fee:t,message:0===t?"FREE":`RM ${t.toFixed(2)}`,reason:0===t?`Free shipping for orders over RM ${r.minSpend}!`:"Standard Shipping"}}return{fee:14,message:"RM 14.00"}}
    function updateCartDisplay(){const t=document.getElementById("cart-items"),e=document.getElementById("cart-subtotal"),o=document.getElementById("discount-line"),n=document.getElementById("cart-discount"),i=document.getElementById("cart-shipping"),r=document.getElementById("cart-total"),a=document.getElementById("points-earned-display"),s=document.getElementById("savings-line"),d=document.getElementById("cart-savings");if(0===cart.length)return t.innerHTML="<p>Your cart is currently empty.</p>",e.textContent="RM 0.00",i.textContent="RM 0.00",r.textContent="RM 0.00",a.innerHTML="",o.style.display="none",s.style.display="none",void updateCartCount();const{subtotal:c,originalSubtotal:l,discountValue:u,shipping:m,total:p,totalPoints:f,itemFinalPrices:g}=calculateCartTotals();let h="";cart.forEach(t=>{const e=g[t.id]||t.basePrice;let o=`<div class="final-cart-price">RM ${e.toFixed(2)}</div>`;e<t.basePrice&&(o+=`<div class="original-cart-price">RM ${t.basePrice.toFixed(2)}</div>`),h+=`<div class="cart-item"><div class="cart-item-details"><strong>${t.name}</strong><div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantity(${t.id})">-</button><span class="quantity-display">${t.quantity}</span><button class="quantity-btn" onclick="increaseQuantity(${t.id})">+</button></div></div><div style="text-align:right">${o}</div></div>`});const y=l-c+u;t.innerHTML=h,e.textContent=`RM ${c.toFixed(2)}`,u>0?(n.textContent=`- RM ${u.toFixed(2)}`,o.style.display="flex"):(o.style.display="none"),"FREE"===m.message?i.innerHTML=`<span style="color:var(--accent-color);font-weight:700"><i class="fa-solid fa-truck-fast"></i> FREE! <small>(${m.reason})</small></span>`:i.innerHTML=m.message,y>0?(d.textContent=`RM ${y.toFixed(2)}`,s.style.display="flex"):(s.style.display="none"),r.textContent=`RM ${p.toFixed(2)}`,a.innerHTML=`<div class="points-earned"><i class="fa-solid fa-star"></i> Points to be Earned: ${f}</div>`,updateCartCount()}
    async function initiateCheckout(){if(!document.getElementById("consent-checkbox").checked)return void alert("You must agree to the data collection consent before proceeding.");const t=document.getElementById("customer-name").value.trim(),e=document.getElementById("customer-phone").value.trim(),o=document.getElementById("customer-email").value.trim(),n=document.getElementById("customer-address1").value.trim(),i=document.getElementById("customer-address2").value.trim(),r=document.getElementById("customer-city").value.trim(),a=document.getElementById("customer-state").value.trim(),s=document.getElementById("customer-postcode").value.trim();if(!t||!e||!o||!n||!r||!a||!s)return void alert("Please fill in all required customer and shipping information fields.");if(0===cart.length)return void alert("Your cart is empty.");const{subtotal:d,discountValue:c,shipping:l,total:u,totalPoints:m,itemFinalPrices:p}=calculateCartTotals(),f=`${n}, ${i?i+", ":""}${s} ${r}, ${a}.`,g={customerName:t,customerPhone:e,customerEmail:o,customerAddress:f,cart:cart.map(t=>({id:t.id,name:t.name,quantity:t.quantity,finalPrice:p[t.id]})),totalAmount:u.toFixed(2),shippingFee:l.fee.toFixed(2),discountApplied:appliedDiscount?`${appliedDiscount.code} - RM ${c.toFixed(2)}`:"N/A",discountCodeUsed:appliedDiscount?appliedDiscount.code:"N/A",totalPointsForThisPurchase:m};sessionStorage.setItem("pendingOrder",JSON.stringify(g));let h=`Hi, I would like to place an order:\n\n*Customer Details:*\nName: ${t}\nPhone: ${e}\nEmail: ${o}\nAddress: ${f}\n\n--- ORDER SUMMARY ---\nSubtotal: RM ${d.toFixed(2)}${c>0?`\nDiscount: - RM ${c.toFixed(2)}`:""}\nShipping: ${l.message}\n*TOTAL: RM ${u.toFixed(2)}*\n\nPlease provide payment details. After payment, I will upload the proof and verification code on your website to finalize the order. Thank you!`;window.open(`https://wa.me/601111033154?text=${encodeURIComponent(h)}`,"_blank"),document.getElementById("cart-view").style.display="none",document.getElementById("verification-view").style.display="block",updateVerificationUI()}
    async function uploadProof(){const t=document.getElementById("payment-proof-upload").files[0],e=document.getElementById("upload-status"),o=document.getElementById("upload-proof-btn");let n=JSON.parse(sessionStorage.getItem("pendingOrder"));if(!t)return e.textContent="Please select a file to upload.",void(e.style.color="red");if(!n)return e.textContent="Error: No pending order found.",void(e.style.color="red");o.disabled=!0,e.textContent="Uploading...",e.style.color="blue";try{const t=await getBase64(proofFile),i={action:"logInitialOrderWithProof",customerName:n.customerName,customerEmail:n.customerEmail,customerPhone:n.customerPhone,customerAddress:n.customerAddress,itemsPurchased:n.cart.map(t=>`${t.name} (x${t.quantity})`).join("; "),discountApplied:n.discountApplied,totalAmount:n.totalAmount,shippingFee:n.shippingFee,totalPointsForThisPurchase:n.totalPointsForThisPurchase,paymentProofFile:t.split(",")[1],paymentProofMimeType:proofFile.type,paymentProofFileName:`${n.customerEmail.split("@")[0]}-${Date.now()}`},r=await fetch(googleScriptURL,{method:"POST",body:JSON.stringify(i)}),a=await r.json();if("success"===a.status)e.textContent="Proof uploaded successfully!",e.style.color="green",n.proofUploaded=!0,sessionStorage.setItem("pendingOrder",JSON.stringify(n)),updateVerificationUI();else throw new Error(a.message)}catch(t){e.textContent=`Error: ${t.message}`,e.style.color="red",o.disabled=!1}}
    async function finalizeOrder(){const t=document.getElementById("verification-code").value.trim().toUpperCase(),e=document.getElementById("finalize-order-btn"),o=document.getElementById("verification-status");let n=JSON.parse(sessionStorage.getItem("pendingOrder"));if(!t)return o.textContent="Please enter the verification code.",void(o.style.color="red");if(!n)return o.textContent="Error: No pending order found.",void(o.style.color="red");e.disabled=!0,o.textContent="Verifying...",o.style.color="blue";try{const i={action:"finalizeOrder",usedCode:t,customerName:n.customerName,customerEmail:n.customerEmail,customerPhone:n.customerPhone,customerAddress:n.customerAddress,cart:n.cart,totalAmount:n.totalAmount,shippingFee:n.shippingFee,discountApplied:n.discountApplied,discountCodeUsed:n.discountCodeUsed,totalPointsForThisPurchase:n.totalPointsForThisPurchase},r=await fetch(googleScriptURL,{method:"POST",body:JSON.stringify(i)}),a=await r.json();if("success"!==a.status)throw new Error(a.message);o.textContent="Order Verified! Your receipt is downloading...",o.style.color="green";const s=document.createElement("a");s.href=a.receiptUrl.replace("/file/d/","/uc?export=download&id=").replace("/view?usp=drivesdk",""),s.download=`Receipt-Order-${(new Date).getTime()}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),cart=[],sessionStorage.removeItem("pendingOrder"),updateCartCount(),appliedDiscount=null,document.getElementById("discount-code-input").value="",document.getElementById("discount-status").textContent="",setTimeout(()=>{toggleCart(!0),updateVerificationUI(!0)},4e3)}catch(t){o.textContent=`Error: ${t.message}`,o.style.color="red",e.disabled=!1}}
    function updateVerificationUI(t=!1){const e=document.getElementById("proof-upload-step"),o=document.getElementById("code-verification-step"),n=document.getElementById("upload-proof-btn"),i=document.getElementById("finalize-order-btn"),r=document.getElementById("verification-code"),a=document.getElementById("upload-status"),s=document.getElementById("verification-status");if(t)return e.classList.add("active"),e.classList.remove("completed"),o.classList.remove("active"),n.disabled=!1,i.disabled=!0,r.disabled=!0,a.textContent="",s.textContent="",document.getElementById("payment-proof-upload").value="",void(r.value="");const d=JSON.parse(sessionStorage.getItem("pendingOrder"));d&&d.proofUploaded?(e.classList.remove("active"),e.classList.add("completed"),o.classList.add("active"),n.disabled=!0,i.disabled=!1,r.disabled=!1,a.textContent="Proof Uploaded Successfully!",a.style.color="green"):(e.classList.add("active"),e.classList.remove("completed"),o.classList.remove("active"),n.disabled=!1,i.disabled=!0,r.disabled=!0)}
    function cancelVerification(){confirm("Are you sure? This will cancel the pending order.")&&(sessionStorage.removeItem("pendingOrder"),toggleCart(!0),updateVerificationUI(!0))}
    function toggleCart(t=!1){const e=document.getElementById("cart-modal");if(t)return void(e.style.display="none");"flex"===e.style.display?e.style.display="none":(e.style.display="flex",JSON.parse(sessionStorage.getItem("pendingOrder"))?(document.getElementById("cart-view").style.display="none",document.getElementById("verification-view").style.display="block",updateVerificationUI()):(document.getElementById("cart-view").style.display="block",document.getElementById("verification-view").style.display="none",updateCartDisplay(),updateVerificationUI(!0)))}
    function getBase64(t){return new Promise((e,o)=>{const n=new FileReader;n.readAsDataURL(t),n.onload=()=>e(n.result),n.onerror=t=>o(t)})}
    function filterProducts(){const t=document.getElementById("product-search").value.toLowerCase();document.querySelectorAll(".product").forEach(e=>{e.querySelector("h3").textContent.toLowerCase().includes(t)?e.style.display="flex":e.style.display="none"})}
    function suggestProduct(){const t=document.getElementById("symptom-input").value.toLowerCase().trim(),e=document.getElementById("suggestion-result");if(!t)return void(e.innerHTML='<p style="color:red">Please enter a symptom or health concern.</p>');const o={'digestion':{keywords:['digestion','stomach','tummy','bloated','indigestion','constipation'],ids:[1,2,3,7,11,18]},'immune':{keywords:['immune','sick','flu','cold','cough','fever','infection'],ids:[1,2,14,15,17]},'energy':{keywords:['energy','tired','fatigue','stamina','lethargic','weak'],ids:[12,13,15,8]},'weight':{keywords:['weight','diet','slim','lose weight','kurus'],ids:[4,5,6,7]},'skin':{keywords:['skin','dry','acne','eczema','sunburn','aging','wrinkles','kulit'],ids:[30,32,29,39,52,24,21,22,31,38,41]},'joint':{keywords:['joint','muscle','pain','sore','arthritis','sakit','otot'],ids:[34,16,33]},'heart':{keywords:['heart','cholesterol','blood pressure','jantung'],ids:[16]},'bone':{keywords:['bone','calcium','osteoporosis','tulang'],ids:[19]},'headache':{keywords:['headache','migraine','pening','sakit kepala'],ids:[33]}},n=new Set,i=t.split(" ");i.forEach(t=>{for(const e in o)o[e].keywords.includes(t)&&o[e].ids.forEach(t=>n.add(t))}),n.size>0?(e.innerHTML="<h4>Based on your concern, we suggest:</h4>",[...n].slice(0,3).forEach(t=>{const n=products.find(e=>e.id===t);let i=n.price;const r=activePromotions.find(e=>e.productIDs.includes(t));"PERCENT"===r?.type?i*=(1-parseFloat(r.value)/100):"FIXED"===r?.type&&(i-=parseFloat(r.value)),e.innerHTML+=`<div class="suggestion-product"><span><strong>${n.name}</strong> - ${n.benefits.split(",")[0]}</span><button class="btn btn-primary" style="width:auto;padding:8px 15px" onclick="addToCart(${n.id}, ${i});toggleCart()">Add</button></div>`})):(e.innerHTML="<p>We could not find a specific match. Try searching for products directly.</p>")}
    function sendFeedbackEmail(t){t.preventDefault();const e=document.getElementById("feedback-submit-btn"),o=document.getElementById("feedback-status");if("YOUR_SERVICE_ID"==='YOUR_SERVICE_ID'||"YOUR_TEMPLATE_ID"==='YOUR_TEMPLATE_ID')return o.textContent="Feedback form is not configured. Please contact the owner directly.",void(o.style.color="orange");e.disabled=!0,o.textContent="Sending...",o.style.color="blue"}
</script>
</body>
</html>
