<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forever Living by Mohd Arvind Isa</title>
  <style>
    /* [Previous CSS remains intact] */
    
    /* New Search & Filter Styles */
    .search-filter-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin: 20px 0;
      padding: 15px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    #search-input {
      flex-grow: 1;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      min-width: 200px;
    }
    .filter-dropdown {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: white;
    }
    .filter-btn {
      background: #2c8a58;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
    }
    
    /* Quick View Modal */
    .quick-view-modal {
      display: none;
      position: fixed;
      z-index: 101;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      overflow: auto;
    }
    .quick-view-content {
      background-color: #fefefe;
      margin: 5% auto;
      padding: 30px;
      border-radius: 8px;
      width: 80%;
      max-width: 800px;
      position: relative;
      display: flex;
      gap: 30px;
    }
    .quick-view-close {
      position: absolute;
      right: 20px;
      top: 10px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    .quick-view-image {
      width: 40%;
      max-height: 400px;
      object-fit: contain;
    }
    .quick-view-details {
      width: 60%;
    }
    
    /* Wishlist Styles */
    .wishlist-btn {
      background: #e67e22;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      margin-top: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    .wishlist-btn.active {
      background: #d35400;
    }
    
    /* Reviews System */
    .reviews-container {
      margin-top: 20px;
      border-top: 1px solid #eee;
      padding-top: 20px;
    }
    .review {
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #f5f5f5;
    }
    .review-author {
      font-weight: bold;
      color: #2c8a58;
    }
    .review-date {
      color: #999;
      font-size: 0.8em;
    }
    .review-rating {
      color: #e67e22;
      margin: 5px 0;
    }
    .add-review-btn {
      background: #2c8a58;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      margin-top: 15px;
      cursor: pointer;
    }
    
    /* Responsive Improvements */
    @media (max-width: 768px) {
      .quick-view-content {
        flex-direction: column;
        width: 90%;
        padding: 20px;
      }
      .quick-view-image, .quick-view-details {
        width: 100%;
      }
      nav ul {
        flex-direction: column;
        align-items: center;
      }
      nav li {
        margin: 5px 0;
      }
    }
  </style>
</head>
<body>
  <!-- [Previous header/nav remains the same] -->

  <main>
    <div id="products" class="tab-content active">
      <div class="ai-suggestion-box">
        <h2>AI Product Suggestion</h2>
        <!-- [Previous AI suggestion content] -->
      </div>
      
      <!-- New Search & Filter Section -->
      <div class="search-filter-container">
        <input type="text" id="search-input" placeholder="Search products...">
        <select class="filter-dropdown" id="category-filter">
          <option value="">All Categories</option>
          <option value="nutrition">Nutrition</option>
          <option value="skincare">Skincare</option>
          <option value="bee">Bee Products</option>
          <option value="detox">Detox</option>
        </select>
        <select class="filter-dropdown" id="price-filter">
          <option value="">All Prices</option>
          <option value="0-50">Under RM50</option>
          <option value="50-100">RM50 - RM100</option>
          <option value="100-150">RM100 - RM150</option>
          <option value="150+">Over RM150</option>
        </select>
        <button class="filter-btn" onclick="filterProducts()">Filter</button>
      </div>
      
      <h2>Our Products</h2>
      <div id="product-list" class="product-list"></div>
    </div>

    <!-- [Rest of your existing tab content remains] -->
  </main>

  <!-- Quick View Modal -->
  <div id="quick-view-modal" class="quick-view-modal">
    <div class="quick-view-content">
      <span class="quick-view-close" onclick="closeQuickView()">&times;</span>
      <img id="quick-view-image" class="quick-view-image" src="" alt="Product Image">
      <div class="quick-view-details">
        <h2 id="quick-view-title"></h2>
        <div class="price" id="quick-view-price"></div>
        <div class="benefits" id="quick-view-benefits"></div>
        <div class="consumption" id="quick-view-consumption"></div>
        
        <div class="reviews-container" id="quick-view-reviews">
          <h3>Customer Reviews</h3>
          <div id="reviews-list"></div>
          <button class="add-review-btn" onclick="showReviewForm()">Add Review</button>
        </div>
        
        <div style="margin-top: 20px; display: flex; gap: 10px;">
          <button class="add-to-cart" id="quick-view-add-to-cart">Add to Cart</button>
          <button class="wishlist-btn" id="quick-view-wishlist">
            <span id="wishlist-text">Add to Wishlist</span> ♡
          </button>
          <a href="#" class="whatsapp-btn" id="quick-view-whatsapp">Order via WhatsApp</a>
        </div>
      </div>
    </div>
  </div>

  <!-- [Previous cart modal and footer remain] -->

  <script>
    // [Previous product data and cart functions remain]
    
    // Enhanced product data with categories and sample reviews
    products.forEach(product => {
      // Add categories
      if (product.name.toLowerCase().includes('aloe')) {
        product.category = 'nutrition';
        if (product.name.toLowerCase().includes('gel') || 
            product.name.toLowerCase().includes('nectar')) {
          product.category = 'detox';
        }
      }
      if (product.name.toLowerCase().includes('bee')) {
        product.category = 'bee';
      }
      if (product.name.toLowerCase().includes('cream') || 
          product.name.toLowerCase().includes('shampoo') ||
          product.name.toLowerCase().includes('soap')) {
        product.category = 'skincare';
      }
      
      // Add sample reviews
      product.reviews = [
        {
          author: "Siti A.",
          rating: 5,
          date: "2023-10-15",
          comment: "This product changed my life! I feel so much more energetic."
        },
        {
          author: "Rajesh K.",
          rating: 4,
          date: "2023-09-22",
          comment: "Good quality, delivery was fast. Will buy again."
        }
      ];
    });

    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    
    function renderProducts(productsToRender = products) {
      const productList = document.getElementById('product-list');
      productList.innerHTML = productsToRender.map(product => `
        <div class="product" data-id="${product.id}" data-category="${product.category || 'other'}" data-price="${product.price}">
          <img src="${product.image}" alt="${product.name}" 
               onclick="showQuickView(${product.id})"
               onerror="this.onerror=null;this.src='https://via.placeholder.com/200x200?text=Product+Image'">
          <h3 onclick="showQuickView(${product.id})" style="cursor:pointer;">${product.name}</h3>
          <div class="price">RM ${product.price.toFixed(2)}</div>
          <div class="benefits"><strong>Benefits:</strong> ${product.benefits}</div>
          <button class="add-to-cart" onclick="addToCart(${product.id})">Add to Cart</button>
          <button class="wishlist-btn" onclick="toggleWishlist(${product.id})" data-id="${product.id}">
            ${wishlist.includes(product.id) ? 'In Wishlist ♥' : 'Add to Wishlist ♡'}
          </button>
          <a href="https://wa.me/601111033154?text=I%20want%20to%20buy%20${encodeURIComponent(product.name)}" 
             class="whatsapp-btn">Order via WhatsApp</a>
        </div>
      `).join('');
    }

    function filterProducts() {
      const searchTerm = document.getElementById('search-input').value.toLowerCase();
      const category = document.getElementById('category-filter').value;
      const priceRange = document.getElementById('price-filter').value;
      
      let filtered = products.filter(product => {
        // Search term filter
        const matchesSearch = product.name.toLowerCase().includes(searchTerm) || 
                            product.benefits.toLowerCase().includes(searchTerm);
        
        // Category filter
        const matchesCategory = !category || (product.category === category);
        
        // Price filter
        let matchesPrice = true;
        if (priceRange) {
          const [min, max] = priceRange.split('-').map(Number);
          if (max) {
            matchesPrice = product.price >= min && product.price <= max;
          } else {
            matchesPrice = product.price >= min;
          }
        }
        
        return matchesSearch && matchesCategory && matchesPrice;
      });
      
      renderProducts(filtered);
    }

    function showQuickView(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;
      
      document.getElementById('quick-view-image').src = product.image;
      document.getElementById('quick-view-title').textContent = product.name;
      document.getElementById('quick-view-price').textContent = `RM ${product.price.toFixed(2)}`;
      document.getElementById('quick-view-benefits').innerHTML = `<strong>Benefits:</strong> ${product.benefits}`;
      document.getElementById('quick-view-consumption').innerHTML = `<strong>How to use:</strong> ${product.consumption}`;
      document.getElementById('quick-view-add-to-cart').onclick = () => {
        addToCart(productId);
        closeQuickView();
      };
      document.getElementById('quick-view-wishlist').onclick = () => toggleWishlist(productId);
      document.getElementById('quick-view-whatsapp').href = 
        `https://wa.me/601111033154?text=I%20want%20to%20buy%20${encodeURIComponent(product.name)}`;
      
      // Update wishlist button state
      const isInWishlist = wishlist.includes(productId);
      document.getElementById('wishlist-text').textContent = isInWishlist ? 'In Wishlist' : 'Add to Wishlist';
      document.getElementById('quick-view-wishlist').innerHTML = 
        `${isInWishlist ? 'In Wishlist ♥' : 'Add to Wishlist ♡'}`;
      
      // Display reviews
      const reviewsList = document.getElementById('reviews-list');
      reviewsList.innerHTML = product.reviews.map(review => `
        <div class="review">
          <div class="review-author">${review.author}</div>
          <div class="review-date">${review.date}</div>
          <div class="review-rating">${'★'.repeat(review.rating)}${'☆'.repeat(5-review.rating)}</div>
          <div class="review-comment">${review.comment}</div>
        </div>
      `).join('');
      
      document.getElementById('quick-view-modal').style.display = 'block';
    }

    function closeQuickView() {
      document.getElementById('quick-view-modal').style.display = 'none';
    }

    function toggleWishlist(productId) {
      const index = wishlist.indexOf(productId);
      if (index === -1) {
        wishlist.push(productId);
      } else {
        wishlist.splice(index, 1);
      }
      
      localStorage.setItem('wishlist', JSON.stringify(wishlist));
      renderProducts();
      
      // Update quick view if open
      if (document.getElementById('quick-view-modal').style.display === 'block') {
        const quickViewProductId = parseInt(document.querySelector('.quick-view-details h2').getAttribute('data-id'));
        if (quickViewProductId === productId) {
          const isInWishlist = wishlist.includes(productId);
          document.getElementById('wishlist-text').textContent = isInWishlist ? 'In Wishlist' : 'Add to Wishlist';
          document.getElementById('quick-view-wishlist').innerHTML = 
            `${isInWishlist ? 'In Wishlist ♥' : 'Add to Wishlist ♡'}`;
        }
      }
    }

    function showReviewForm() {
      // In a full implementation, this would show a form to submit reviews
      alert("Review form would appear here. In a full implementation, this would connect to a backend service.");
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      renderProducts();
      showTab('products');
      
      // Close modals when clicking outside
      window.onclick = function(event) {
        const modal = document.getElementById('cart-modal');
        if (event.target === modal) {
          modal.style.display = "none";
        }
        
        const quickView = document.getElementById('quick-view-modal');
        if (event.target === quickView) {
          quickView.style.display = "none";
        }
      }
      
      // Search as you type
      document.getElementById('search-input').addEventListener('input', filterProducts);
    });
  </script>
</body>
</html>
